//
//  Copyright Â© 2018 Weedmaps, LLC. All rights reserved.
//

import XCTest
@testable import WeedmapsChallenge


class YelpAPIClientTests: XCTestCase {

    override func setUp() {
        // Put setup code here. This method is called before the invocation of each test method in the class.
    }

    override func tearDown() {
        // Put teardown code here. This method is called after the invocation of each test method in the class.
    }

    func testBusinessModelDecodedFromJsonYieldsExpectedResult() {
        let json = """
        {"businesses": [{"id": "5HU2s5l-83wUcb6e6DpFIQ", "alias": "ernest-coffee-palm-springs-2", "name": "Ernest Coffee", "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/LR_agbHAyLzDNO4g_3EwDg/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/ernest-coffee-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 323, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}, {"alias": "wine_bars", "title": "Wine Bars"}], "rating": 4.0, "coordinates": {"latitude": 33.837438, "longitude": -116.547023}, "transactions": [], "price": "$", "location": {"address1": "1101 N Palm Canyon Dr", "address2": null, "address3": "", "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["1101 N Palm Canyon Dr", "Palm Springs, CA 92262"]}, "phone": "+17603184154", "display_phone": "(760) 318-4154", "distance": 6411.969490080554}, {"id": "Zd-QbFHElWuHa_V3_tOOhQ", "alias": "koffi-palm-springs-4", "name": "Koffi", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/-Zna5qjMuaum24hCdaUQFw/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/koffi-palm-springs-4?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 521, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}, {"alias": "breakfast_brunch", "title": "Breakfast & Brunch"}], "rating": 4.0, "coordinates": {"latitude": 33.83073, "longitude": -116.54737}, "transactions": [], "price": "$", "location": {"address1": "515 N Palm Canyon Dr", "address2": "", "address3": "", "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["515 N Palm Canyon Dr", "Palm Springs, CA 92262"]}, "phone": "+17604162244", "display_phone": "(760) 416-2244", "distance": 6445.9919912486475}, {"id": "f1Y_I9E5c3raS0rw0WsT2A", "alias": "kreem-palm-springs", "name": "Kreem", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/okXFa5ZpG-8HY58OiiDbLw/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/kreem-palm-springs?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 118, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}, {"alias": "icecream", "title": "Ice Cream & Frozen Yogurt"}], "rating": 5.0, "coordinates": {"latitude": 33.80259, "longitude": -116.54514}, "transactions": [], "price": "$$", "location": {"address1": "170 E Palm Canyon Dr", "address2": "", "address3": null, "city": "Palm Springs", "zip_code": "92264", "country": "US", "state": "CA", "display_address": ["170 E Palm Canyon Dr", "Palm Springs, CA 92264"]}, "phone": "+17606998129", "display_phone": "(760) 699-8129", "distance": 7293.881895649497}, {"id": "O-xhtAK595QLXdx5Q7X7Hg", "alias": "4-paws-coffee-co-palm-springs-2", "name": "4 Paws Coffee Co.", "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/CYAmkVzXfEVMv2-uY8Q-Xg/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/4-paws-coffee-co-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 134, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}, {"alias": "sandwiches", "title": "Sandwiches"}, {"alias": "breakfast_brunch", "title": "Breakfast & Brunch"}], "rating": 4.5, "coordinates": {"latitude": 33.8528151212964, "longitude": -116.551267169416}, "transactions": [], "price": "$", "location": {"address1": "2500 N Palm Canyon Dr", "address2": "Ste A-5", "address3": null, "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["2500 N Palm Canyon Dr", "Ste A-5", "Palm Springs, CA 92262"]}, "phone": "+17608328021", "display_phone": "(760) 832-8021", "distance": 7038.240427832877}, {"id": "Lfnx8DeMO7vUx5mqs7e9hw", "alias": "gr8-coffeehouse-and-art-gallery-palm-springs-2", "name": "gr8 Coffeehouse & Art Gallery", "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/FxR3WQ5V8pYnE6KmKeswCw/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/gr%C3%A9-coffeehouse-and-art-gallery-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 125, "categories": [{"alias": "galleries", "title": "Art Galleries"}, {"alias": "coffee", "title": "Coffee & Tea"}, {"alias": "vinyl_records", "title": "Vinyl Records"}], "rating": 4.5, "coordinates": {"latitude": 33.8260969159094, "longitude": -116.546395929091}, "transactions": [], "price": "$", "location": {"address1": "278 N Palm Canyon Dr", "address2": "Ste C", "address3": null, "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["278 N Palm Canyon Dr", "Ste C", "Palm Springs, CA 92262"]}, "phone": "", "display_phone": "", "distance": 6459.697447113282}, {"id": "FuHWqNvLZL7NsVkwB2t2Jg", "alias": "starbucks-cathedral-city-6", "name": "Starbucks", "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/KE_r4RoKii5dMtsbfhuNog/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/starbucks-cathedral-city-6?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 82, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}], "rating": 3.0, "coordinates": {"latitude": 33.845258, "longitude": -116.477751}, "transactions": [], "price": "$", "location": {"address1": "67870 Vista Chino", "address2": "#101", "address3": "", "city": "Cathedral City", "zip_code": "92234", "country": "US", "state": "CA", "display_address": ["67870 Vista Chino", "#101", "Cathedral City, CA 92234"]}, "phone": "+17608649707", "display_phone": "(760) 864-9707", "distance": 965.5948019486888}, {"id": "NDNPnBOP6p2Ubs_r_s6h-Q", "alias": "cartel-coffee-lab-palm-springs-2", "name": "Cartel Coffee Lab", "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/jrkwtZ6G7GjBqzIwsP0tMw/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/cartel-coffee-lab-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 24, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}], "rating": 4.0, "coordinates": {"latitude": 33.84412, "longitude": -116.54726}, "transactions": [], "location": {"address1": "1551 N Palm Canyon Dr", "address2": null, "address3": "", "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["1551 N Palm Canyon Dr", "Palm Springs, CA 92262"]}, "phone": "+14806216381", "display_phone": "(480) 621-6381", "distance": 6462.249904195661}, {"id": "hKziIzeR-u7DsWZvUgasTA", "alias": "koffi-south-palm-springs", "name": "Koffi South", "image_url": "https://s3-media4.fl.yelpcdn.com/bphoto/-XWRZs3Q-5q_usdeg-rPKA/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/koffi-south-palm-springs?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 368, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}], "rating": 4.0, "coordinates": {"latitude": 33.8009757, "longitude": -116.5389328}, "transactions": [], "price": "$", "location": {"address1": "1700 S Camino Real", "address2": "", "address3": "", "city": "Palm Springs", "zip_code": "92264", "country": "US", "state": "CA", "display_address": ["1700 S Camino Real", "Palm Springs, CA 92264"]}, "phone": "+17603227776", "display_phone": "(760) 322-7776", "distance": 6911.173000860967}, {"id": "S5KFNvqm09cjNJuNwZ0plg", "alias": "koffi-central-palm-springs", "name": "Koffi Central", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/6Ww3jWoGiXdsKZ0LqPT6yg/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/koffi-central-palm-springs?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 35, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}], "rating": 4.5, "coordinates": {"latitude": 33.8232971, "longitude": -116.5405597}, "transactions": [], "price": "$", "location": {"address1": "650 E Tahquitz Canyon Way", "address2": null, "address3": "", "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["650 E Tahquitz Canyon Way", "Palm Springs, CA 92262"]}, "phone": "+17603180145", "display_phone": "(760) 318-0145", "distance": 6037.209594957594}, {"id": "zZd6BHcihD-CwcQHd5L5WA", "alias": "ristretto-palm-springs-2", "name": "Ristretto", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/gnq5_hsXc1jaBq5HcOYduQ/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/ristretto-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 138, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}, {"alias": "cafes", "title": "Cafes"}, {"alias": "sandwiches", "title": "Sandwiches"}], "rating": 4.5, "coordinates": {"latitude": 33.8154830932617, "longitude": -116.546096801758}, "transactions": ["delivery", "pickup"], "price": "$", "location": {"address1": "500 S Palm Canyon Dr", "address2": null, "address3": "", "city": "Palm Springs", "zip_code": "92264", "country": "US", "state": "CA", "display_address": ["500 S Palm Canyon Dr", "Palm Springs, CA 92264"]}, "phone": "+17606567352", "display_phone": "(760) 656-7352", "distance": 6746.246448764856}, {"id": "o5Cc6eqosWA1R_-TNQWdkQ", "alias": "starbucks-cathedral-city-3", "name": "Starbucks", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/Vv5eSkBb1NPsd5pyLL6rjA/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/starbucks-cathedral-city-3?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 48, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}], "rating": 2.5, "coordinates": {"latitude": 33.816278, "longitude": -116.457461}, "transactions": [], "price": "$$", "location": {"address1": "69040 Ramon Road", "address2": "Ste. A", "address3": "", "city": "Cathedral City", "zip_code": "92234", "country": "US", "state": "CA", "display_address": ["69040 Ramon Road", "Ste. A", "Cathedral City, CA 92234"]}, "phone": "+17603245928", "display_phone": "(760) 324-5928", "distance": 2925.2570099724844}, {"id": "V-kDax9L7YT2OlRbAUjRlQ", "alias": "townie-bagels-bakery-cafe-palm-springs", "name": "Townie Bagels Bakery Cafe", "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/0flL4hMREPbCq9OTWkK9kQ/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/townie-bagels-bakery-cafe-palm-springs?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 251, "categories": [{"alias": "bakeries", "title": "Bakeries"}, {"alias": "bagels", "title": "Bagels"}, {"alias": "coffee", "title": "Coffee & Tea"}], "rating": 4.5, "coordinates": {"latitude": 33.812418, "longitude": -116.541615}, "transactions": [], "price": "$", "location": {"address1": "650 E Sunny Dunes Rd", "address2": "", "address3": "", "city": "Palm Springs", "zip_code": "92264", "country": "US", "state": "CA", "display_address": ["650 E Sunny Dunes Rd", "Palm Springs, CA 92264"]}, "phone": "+17604594555", "display_phone": "(760) 459-4555", "distance": 6494.18740597314}, {"id": "MIpYY5kfRzDez4eJ8jdaYA", "alias": "la-michoacana-ice-cream-parlor-cathedral-city", "name": "La Michoacana Ice Cream Parlor", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/kmPWEBp3mOlEqSwbDQQS1w/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/la-michoacana-ice-cream-parlor-cathedral-city?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 111, "categories": [{"alias": "desserts", "title": "Desserts"}, {"alias": "icecream", "title": "Ice Cream & Frozen Yogurt"}], "rating": 4.5, "coordinates": {"latitude": 33.846583, "longitude": -116.476145}, "transactions": ["delivery", "pickup"], "price": "$", "location": {"address1": "27765 Landau Blvd", "address2": "Ste 106", "address3": "", "city": "Cathedral City", "zip_code": "92234", "country": "US", "state": "CA", "display_address": ["27765 Landau Blvd", "Ste 106", "Cathedral City, CA 92234"]}, "phone": "+17605078477", "display_phone": "(760) 507-8477", "distance": 1121.0103290017505}, {"id": "IBrnC66nOXc7vHLftGOM7g", "alias": "farm-palm-springs", "name": "FARM", "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/_6fwLkl8y7uz-hM1ldB--w/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/farm-palm-springs?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 1640, "categories": [{"alias": "newamerican", "title": "American (New)"}, {"alias": "french", "title": "French"}, {"alias": "breakfast_brunch", "title": "Breakfast & Brunch"}], "rating": 4.5, "coordinates": {"latitude": 33.8222433658555, "longitude": -116.546175028644}, "transactions": [], "price": "$$", "location": {"address1": "6 La Plz", "address2": null, "address3": "", "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["6 La Plz", "Palm Springs, CA 92262"]}, "phone": "+17603222724", "display_phone": "(760) 322-2724", "distance": 6530.905372718235}, {"id": "8erhTXVTWkDZ2__qgFQCZg", "alias": "starbucks-palm-springs-15", "name": "Starbucks", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/1qRReDgU3d-U7W14sRE_1g/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/starbucks-palm-springs-15?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 126, "categories": [{"alias": "coffee", "title": "Coffee & Tea"}], "rating": 3.5, "coordinates": {"latitude": 33.823395, "longitude": -116.54717}, "transactions": [], "price": "$$", "location": {"address1": "110 North Palm Canyon Drive", "address2": "", "address3": null, "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["110 North Palm Canyon Drive", "Palm Springs, CA 92262"]}, "phone": "+17603182287", "display_phone": "(760) 318-2287", "distance": 6590.374187426795}, {"id": "arRSFFnC5PsTdqVld7jheQ", "alias": "don-and-sweet-sues-cafe-cathedral-city", "name": "Don & Sweet Sue's Cafe", "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/3meio2330xN45aTEeSlqhQ/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/don-and-sweet-sues-cafe-cathedral-city?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 397, "categories": [{"alias": "breakfast_brunch", "title": "Breakfast & Brunch"}, {"alias": "tradamerican", "title": "American (Traditional)"}, {"alias": "desserts", "title": "Desserts"}], "rating": 4.0, "coordinates": {"latitude": 33.815624, "longitude": -116.4589}, "transactions": [], "price": "$$", "location": {"address1": "68955 Ramon Rd", "address2": "Ste 1", "address3": "", "city": "Cathedral City", "zip_code": "92234", "country": "US", "state": "CA", "display_address": ["68955 Ramon Rd", "Ste 1", "Cathedral City, CA 92234"]}, "phone": "+17607702760", "display_phone": "(760) 770-2760", "distance": 2880.6566324968217}, {"id": "wGIDkmwgA0gx2u8xCtveOQ", "alias": "aspen-mills-bread-bakery-and-cafe-palm-springs-2", "name": "Aspen Mills Bread Bakery & Cafe", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/UOCPYHomHSZ9vtPYR-xS-Q/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/aspen-mills-bread-bakery-and-cafe-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 208, "categories": [{"alias": "bakeries", "title": "Bakeries"}, {"alias": "cafes", "title": "Cafes"}], "rating": 4.5, "coordinates": {"latitude": 33.815400018861, "longitude": -116.528808808649}, "transactions": [], "price": "$", "location": {"address1": "555 S Sunrise Way", "address2": "Ste 101", "address3": "", "city": "Palm Springs", "zip_code": "92264", "country": "US", "state": "CA", "display_address": ["555 S Sunrise Way", "Ste 101", "Palm Springs, CA 92264"]}, "phone": "+17603233123", "display_phone": "(760) 323-3123", "distance": 5283.255781897008}, {"id": "UdjHmhPtXUsjd1FakjwPkA", "alias": "villa-bakery-cathedral-city", "name": "Villa Bakery", "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/BBvVvT3coNTomqKRICAlHQ/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/villa-bakery-cathedral-city?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 48, "categories": [{"alias": "bakeries", "title": "Bakeries"}, {"alias": "mexican", "title": "Mexican"}], "rating": 4.5, "coordinates": {"latitude": 33.8158802411682, "longitude": -116.484303474426}, "transactions": [], "price": "$", "location": {"address1": "67470 Ramon Rd", "address2": "", "address3": "", "city": "Cathedral City", "zip_code": "92234", "country": "US", "state": "CA", "display_address": ["67470 Ramon Rd", "Cathedral City, CA 92234"]}, "phone": "+17603225701", "display_phone": "(760) 322-5701", "distance": 2382.814943183055}, {"id": "faexN5tMFuTGoFWGJ9W8rw", "alias": "vienna-donut-and-ice-cream-cathedral-city", "name": "Vienna Donut & Ice Cream", "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/3X8W1a0YwtqMTlRQfkDN8A/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/vienna-donut-and-ice-cream-cathedral-city?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 81, "categories": [{"alias": "donuts", "title": "Donuts"}], "rating": 4.5, "coordinates": {"latitude": 33.81561, "longitude": -116.46402}, "transactions": [], "price": "$", "location": {"address1": "68655 Ramon Rd", "address2": null, "address3": null, "city": "Cathedral City", "zip_code": "92234", "country": "US", "state": "CA", "display_address": ["68655 Ramon Rd", "Cathedral City, CA 92234"]}, "phone": "+17603215855", "display_phone": "(760) 321-5855", "distance": 2644.3883369827904}, {"id": "lMvp9vQnQGoM07RVTssbCg", "alias": "carousel-bakery-palm-springs-2", "name": "Carousel Bakery", "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/XCzCLoFR1AYZ2T0Prz0Pzw/o.jpg", "is_closed": false, "url": "https://www.yelp.com/biz/carousel-bakery-palm-springs-2?adjust_creative=EqjmMoJJ58HEH9g9KZHlOw&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=EqjmMoJJ58HEH9g9KZHlOw", "review_count": 59, "categories": [{"alias": "bakeries", "title": "Bakeries"}, {"alias": "sandwiches", "title": "Sandwiches"}, {"alias": "customcakes", "title": "Custom Cakes"}], "rating": 5.0, "coordinates": {"latitude": 33.81677, "longitude": -116.51005}, "transactions": [], "price": "$", "location": {"address1": "440 El Cielo Rd", "address2": "Ste 5", "address3": null, "city": "Palm Springs", "zip_code": "92262", "country": "US", "state": "CA", "display_address": ["440 El Cielo Rd", "Ste 5", "Palm Springs, CA 92262"]}, "phone": "+17606995006", "display_phone": "(760) 699-5006", "distance": 3674.561239269826}], "total": 179, "region": {"center": {"longitude": -116.477608, "latitude": 33.836575}}}
""".data(using: .utf8)
        
        guard let data = json else {
            XCTFail("data not properly encoded")
            return
        }
        
        do {
            let searchResult = try JSONDecoder().decode(Coffeebusinesses.self, from: data)
            XCTAssertTrue(searchResult.businesses?.count == 20)
            XCTAssertTrue(searchResult.total == 179)
            XCTAssertNotNil(searchResult)
        } catch {
            XCTFail("data not properly encoded")
        }
    }
    
    func testYelpAPIRequestYieldsExpectedResult() {
        let fetchResponseExpectation = expectation(description: "fetch response")
        BusinessesSearch().get(query: "Coffee") { (result) in
            switch result {
            case .failure(let error):
                XCTFail("Success case failed error: \(error)")
            case .success(let data):
                XCTAssertTrue(data?.count == 15)
            }
            
            fetchResponseExpectation.fulfill()
        }
        waitForExpectations(timeout: 25, handler: nil)
    }
}
